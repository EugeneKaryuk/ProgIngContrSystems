# cURL

https://curl.se/docs/manpage.htm

https://curl.se/docs/manual.htmll

https://uk.wikipedia.org/wiki/CURL

https://gist.github.com/subfuzion/08c5d85437d5d4f00e58

## Вступ

**cURL** — назва проєкту і крос-платформового програмного засобу, що служить для передачі даних через Інтернет. cURL — це утиліта для організації вибірки даних з вебу, що надає можливість гнучкого формування запиту із завданням таких параметрів, як cookie, user_agent, referrer і будь-яких інших заголовків. cURL — це додаткова можливість оперувати з файлами на боці сервера сторінок Інтернету за допомогою параметрів, що можуть бути переданими в рядку URL. За допомогою cURL можна, наприклад, отримати html-сторінку, не використовуючи для цього браузер.

У Windows `curl` не вбудовано але він ставиться разом з Git, тому можна його знайти за наступною локацією `C:\Program Files\Git\mingw64\bin`. 

Крім http-запитів, cURL підтримує SMTP, IMAP, POP3, Telnet, FTP, LDAP, RTSP, RTMP та інші мережеві протоколи.

Разом з утилітою cURL, проєкт паралельно розвиває бібліотеку libcurl, що надає API для задіяння всіх функцій cURL в програмах на таких мовах, як С, Perl, PHP, Python. 

Базове використання cURL полягає у простому наборі у командній консолі команди curl, за якою іде URL для завантаження. Наприклад, щоб забрати сторінку example.com, наберіть:

```bash
curl www.example.com
```

cURL за замовчуванням відображає вивід отриманого у стандартний потік виводу системи (зазвичай це вікно терміналу). Отже, запуск наведеної  вище команди на більшості систем просто покаже програмний код сторінки  `www.example.com` в вікні терміналу. cURL може записати вивід до файлу при використанні прапорця `-o`:

```bash
curl -o example.html www.example.com
```

Це збереже код для `www.example.com` у файлі example.html. Під час  отримання виводу cURL покаже прогрес завантаження. Проте, cURL не  показує прогрес при виводі у термінал, бо це може заважати виводу самого завантаженого коду. 

Щоб завантажити вивід у файл з таким самим ім'ям, що і у системі, з якої він завантажується, використовуйте прапорець `-O`, наприклад:

```
curl -O www.example.com/example.html
```

Якщо сервер відповідає, що файл переміщено (показано за допомогою  Location: header та кодом відповіді `3XX`), то використовуйте прапорець `-L`, наприклад:

```
curl -OL www.example.com/example.html
```

cURL може під'єднатися до сервера за допомогою протоколу HTTPS і поверне помилку, якщо сертифікат не знайдено:

```
curl https://securesite.com/login.html
```

Тоді, щоб вказати файл сертифікату:

```
curl --cacert c:\temp\cacerts.crt https://securesite.com/login.html
```

Щоб оминути перевірку сертифікату (увага: це небезпечно):

```
curl --insecure https://self-signed-cert.com/login.html
```

Curl має багато інших можливостей, серед яких підтримка  проксі-серверів, автентифікації користувача, завантаження по FTP, запити по HTTP, SSL-під'єднання, куки (cookies), довантаження файлів,  Metalink, та багато іншого.

## POST (HTTP)

Розміщувати дані за допомогою curl легко. Це робиться за допомогою параметра `-d <дані>`. Дані повідомлення мають бути закодовані urlencode. Опублікуйте просту гостьову книгу  `name` та `phone` .

```bash
curl -d "name=Rafael%20Sagula&phone=3320780" http://www.where.com/guest.cgi
```

Як розмістити форму з curl, урок №1:

- Викопайте всі теги `<input>` у формі, яку ви хочете заповнити.

- Якщо є звичайна публікація, ви використовуєте `-d` для публікації. `-d` приймає повний рядок повідомлення, який знаходиться у форматі

```bash
<variable1>=<data1>&<variable2>=<data2>&...
```

Імена змінних — це імена, задані за допомогою `"name="` у тегах `<input>`, а дані — це вміст, який ви хочете заповнити для вхідних даних. Дані *повинні* бути правильно закодовані в URL. Це означає, що ви замінюєте пробіл на `+`, а дивні літери — на `%XX`, де `XX` — це шістнадцяткове представлення коду ASCII літери.

Приклад: (сторінка розташована за адресою `http://www.formpost.com/getthis/`)

```html
<form action="post.cgi" method="post">
<input name=user size=10>
<input name=pass type=password size=10>
<input name=id type=hidden value="blablabla">
<input name=ding value="submit">
</form>
```

Ми хочемо ввести користувача `foobar` з паролем `12345`. Щоб опублікувати це, ви вводите командний рядок curl, наприклад:

```bash
curl -d "user=foobar&pass=12345&id=blablabla&ding=submit"
  http://www.formpost.com/getthis/post.cgi
```

У той час як `-d` використовує mime-тип `application/x-www-form-urlencoded`, який зазвичай розуміється CGI та подібними, curl також підтримує більш потужний тип `multipart/form-data`. Останній тип підтримує такі речі, як завантаження файлів.

`-F` приймає такі параметри, як `-F "name=contents"`. Якщо ви хочете, щоб вміст було прочитано з файлу, використовуйте `@filename` як вміст. Указуючи файл, ви також можете вказати тип вмісту файлу, додавши `;type=<тип mime>` до імені файлу. Ви також можете опублікувати вміст кількох файлів в одному полі. Наприклад, назва поля `coolfiles` використовується для надсилання трьох файлів із різними типами вмісту з використанням такого синтаксису:

```bash
curl -F "coolfiles=@fil1.gif;type=image/gif,fil2.txt,fil3.html"
  http://www.post.com/postit.cgi
```

Якщо тип вмісту не вказано, curl намагатиметься вгадати розширення файлу (він знає лише кілька) або використовуватиме попередньо вказаний тип (з попереднього файлу, якщо кілька файлів указано у списку), інакше він буде використовувати типовий тип `application/octet-stream`.

Емулюємо форму заповнення за допомогою `-F`. Припустимо, ви заповнюєте три поля у формі. Одне поле — це ім’я файлу, який потрібно опублікувати, одне поле — ваше ім’я, а одне — опис файлу. Ми хочемо опублікувати створений нами файл під назвою `cooltext.txt`. Щоб дозволити curl публікувати ці дані замість вашого улюбленого браузера, вам потрібно прочитати вихідний код HTML сторінки форми та знайти назви полів введення. У нашому прикладі імена полів введення: `file`, `yourname` і `filedescription`.

```bash
curl -F "file=@cooltext.txt" -F "yourname=Daniel"
  -F "filedescription=Cool text file with cool text inside"
  http://www.post.com/postit.cgi
```

Щоб надіслати два файли в одній публікації, ви можете зробити це двома способами:

- Надсилайте кілька файлів в одному полі з одним ім’ям поля:

```bash
curl -F "pictures=@dog.gif,cat.gif" $URL
```

- Надішліть два поля з двома назвами полів

```bash
curl -F "docpicture=@dog.gif" -F "catpicture=@cat.gif" $URL
```

Щоб надіслати значення поля буквально без інтерпретації `@` або `<`, або вбудованого `;type=`, використовуйте `--form-string` замість `-F`. Це рекомендовано, коли значення отримано від користувача чи іншого непередбачуваного джерела. За таких обставин використання `-F` замість `--form-string` може дозволити користувачеві обманом змусити curl завантажити файл.

