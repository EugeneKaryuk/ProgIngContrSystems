# Web Apps

https://developers.google.com/apps-script/guides/web

Якщо ви створюєте інтерфейс користувача для сценарію, ви можете опублікувати сценарій як веб-програму. Наприклад, сценарій, який дозволяє користувачам планувати зустрічі з членами групи підтримки, найкраще представити як веб-додаток, щоб користувачі могли отримати до нього доступ безпосередньо зі своїх браузерів.

Як [автономні сценарії](https://developers.google.com/apps-script/guides/standalone), так і [сценарії, пов’язані з програмами Google Workspace](https://developers.google.com/apps -script/guides/ bound) можна перетворити на веб-програми, якщо вони відповідають наведеним нижче вимогам:

- Він містить функцію `doGet(e)` або `doPost(e)`.
- Функція повертає [HTML service](https://developers.google.com/apps-script/guides/html) [`HtmlOutput`](https://developers.google.com/apps-script/reference/ html/html-output) або [Content service](https://developers.google.com/apps-script/guides/content) [`TextOutput`](https://developers.google.com/apps- script/reference/content/text-output).

## Параметри запиту

Коли користувач відвідує програму або програма надсилає програмі HTTP-запит `GET`, Apps Script запускає функцію `doGet(e)`. Коли програма надсилає програмі HTTP-запит `POST`, Apps Script замість цього виконує `doPost(e)`. В обох випадках аргумент `e` представляє параметр події, який може містити інформацію про будь-які параметри запиту. Структура об’єкта події наведена в таблиці нижче:

`e.queryString` - Значення частини рядка запиту URL-адреси або значення null, якщо рядок запиту не вказано. 	

```http
name=alice&n=1&n=2
```

`e.parameter` - Об’єкт з пар ключ/значення, які відповідають параметрам запиту. Для параметрів, які мають кілька значень, повертається лише перше значення. 	

```json
{"name": "alice", "n": "1"}
```

`e.parameters`	- Об’єкт, подібний до `e.parameter`, але з масивом значень для кожного ключа

```json
{"name": ["alice"], "n": ["1", "2"]}
```

`e.pathInfo` - URL-шлях після `/exec` або `/dev`. Наприклад, якщо URL-шлях закінчується на `/exec/hello`, інформація про шлях буде `hello`.	

`e.contextPath` Не використовується, завжди порожній рядок.

`e.contentLength` - Довжина тіла запиту для запитів POST або `-1` для запитів GET.

```
332
```

`e.postData.length`  - те саме що `e.contentLength`

```
332
```

`e.postData.type` - Тип MIME тіла POST	

```
text/csv
```

`e.postData.contents` - Текст вмісту тіла POST	

```
Alice,21
```

`e.postData.name ` - Завжди значення `postData`

Наприклад, ви можете передати такі параметри, як  `username`  та  `age` до URL-адреси, як показано нижче:

```http
https://script.google.com/.../exec?username=jsmith&age=21
```

Потім ви можете відобразити параметри так:

```js
function doGet(e) {
  var params = JSON.stringify(e);
  return HtmlService.createHtmlOutput(params);
}
```

У наведеному вище прикладі `doGet(e)` повертає такий результат:

```json
{
  "queryString": "username=jsmith&age=21",
  "parameter": {
    "username": "jsmith",
    "age": "21"
  },
  "contextPath": "",
  "parameters": {
    "username": [
      "jsmith"
    ],
    "age": [
      "21"
    ]
  },
  "contentLength": -1
}
```

Наступні назви параметрів зарезервовані системою, і їх не можна використовувати в параметрах URL-адреси або тілах POST:    `c` та  `sid`. Використання цих параметрів може призвести до відповіді HTTP 405 із повідомленням про помилку «Sorry, the file you have requested does not exist». Якщо можливо, оновіть свій сценарій, щоб використовувати інші назви параметрів.

## Розгорніть сценарій як web app 

Щоб розгорнути сценарій як веб-програму, виконайте такі дії:

1. У верхньому правому куті проекту сценарію натисніть **Ввести в дію** > **Нове введення в дію**.
2. Поруч із «Виберіть тип» натисніть Увімкнути параметри типів розгортання > **Веб-додаток**.
3. Введіть інформацію про свою веб-програму в поля в розділі «Конфігурація введення в дію».
4. Натисніть **Ввести в дію**.

Ви можете поділитися URL-адресою веб-додатками з тими, кому ви хочете використовувати вашу програму, якщо ви надали їм доступ.

**Примітка.** Веб-програми, розгорнуті в одному домені, припиняють роботу, якщо їхнє право власності змінюється на [спільний диск](https://developers.google.com/apps-script/guides/collaborating#collaborating_with_shared_drives) або обліковий запис у інший домен. Це можна виправити, попросивши нового власника або співавтора повторно розгорнути веб-програму в новому домені. Крім того, якщо веб-програму повернути до вихідного домену, веб-програма знову почне працювати для цього домену без повторного розгортання.

## Перевірте розгортання веб-програми

Щоб перевірити свій сценарій як веб-програму, виконайте наведені нижче дії.

1. У верхньому правому куті проекту сценарію натисніть **Deploy > Test deployments**.

2. Поруч із «Виберіть тип» натисніть Увімкнути параметри типів розгортання **> Веб-програма**.

3. Під URL-адресою веб-програми натисніть **Копіювати**.

4. Вставте URL-адресу у свій веб-переглядач і перевірте свою веб-програму.

    Ця URL-адреса закінчується на `/dev`, і до неї можуть отримати доступ лише користувачі, які мають доступ до редагування сценарію. Цей екземпляр програми завжди запускає останній збережений код і призначений лише для тестування під час розробки.

**Попередження.** Розгортаючи веб-програми для запуску від імені розробника, ви повинні бути дуже обережними під час роботи з маркерами OAuth, отриманими через [ScriptApp.getOAuthToken()](https://developers.google.com/apps-script/reference /script/script-app#getoauthtoken). Ці маркери можуть надавати іншим програмам доступ до ваших даних — ніколи не передавати їх клієнту.

## Дозволи

Дозволи для веб-програми відрізняються залежно від способу запуску програми:

- **Виконуйте програму від імені мене** — у цьому випадку сценарій завжди виконується від імені вас, власника сценарію, незалежно від того, хто отримує доступ до веб-програми.
- **Виконати програму від імені користувача, який отримує доступ до веб-програми** — у цьому випадку сценарій виконується від імені активного користувача, який використовує веб-програму. Цей підхід дозволу змушує веб-програму показувати електронну адресу власника сценарію, коли користувач авторизує доступ.

**Попередження.** Щоб запобігти зловживанням, Apps Script накладає обмеження на швидкість, з якою нові користувачі можуть авторизувати веб-програму, яка виконується від імені користувача. Ці обмеження залежать, серед інших факторів, від того, чи обліковий запис публікації є частиною домену [Google Workspace](https://gsuite.google.com/).

**Примітка.** Ви можете співпрацювати над веб-додатками за допомогою [спільного диска](https://developers.google.com/apps-script/guides/collaborating#collaborating_with_shared_drives). Коли веб-програма в спільному доступі розгортається, вибір «виконувати як ви» призводить до того, що веб-програма виконуватиметься під керуванням користувача, який її розгорнув (оскільки немає власника сценарію).